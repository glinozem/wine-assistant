# Wine Assistant — Project Structure

Generated: 2025-12-23

This document is regenerated strictly from two inputs:
1) `git ls-files` → `project-files.tracked.txt` (authoritative list of tracked files)
2) `tree /F /A` + `Dump-Dir` outputs → `project-structure-auto.txt` and `ls_*.txt` (authoritative snapshot of what exists in the working directory, including untracked artifacts)

## Key entrypoints (tracked)
- `api/app.py`
- `api/export.py`
- `api/wsgi.py`
- `api/templates/ui.html`
- `db/init.sql`
- `db/migrate.sh`
- `db/migrate.ps1`
- `docker-compose.yml`
- `docker-compose.observability.yml`
- `docker-compose.storage.yml`
- `Makefile`

## Tracked repository tree (from `git ls-files`, depth ≤ 5)

Tracked files: 186

```
.
├── .github
│   ├── workflows
│   │   ├── changelog-on-release.yml
│   │   ├── ci.yml
│   │   ├── release-drafter.yml
│   │   ├── secrets.yml
│   │   └── semgrep.yml
│   ├── changelog-config.json
│   └── release-drafter.yml
├── .hooks
│   └── block_keys.py
├── api
│   ├── templates
│   │   └── ui.html
│   ├── app.py
│   ├── export.py
│   ├── logging_config.py
│   ├── request_middleware.py
│   ├── schemas.py
│   ├── validation.py
│   └── wsgi.py
├── data
│   └── sample
│       └── dw_sample_products.csv
├── db
│   ├── migrations
│   │   ├── _legacy
│   │   │   ├── 2025-10-14-diagnostics.sql
│   │   │   ├── 2025-10-14-price-check.sql
│   │   │   ├── 2025-10-14-price-history-guardrails.sql
│   │   │   └── 2025-10-14-prices-and-search.sql
│   │   ├── 0000_schema_migrations.sql
│   │   ├── 0001_prices-and-search.sql
│   │   ├── 0002_price-history-guardrails.sql
│   │   ├── 0003_inventory-columns-and-asof.sql
│   │   ├── 0004_diagnostics.sql
│   │   ├── 0005_price-check.sql
│   │   ├── 0006_add-idempotency-tables.sql
│   │   ├── 0007_schema-migrations-view.sql
│   │   ├── 0008_schema-migrations-view.sql
│   │   ├── 0009_schema-migrations-view-fix.sql
│   │   ├── 0010_price-list-quarantine.sql
│   │   ├── 0011_product_prices_partitioning.sql
│   │   ├── 0011_products_extra_fields.sql
│   │   ├── 0012_wineries.sql
│   │   └── 0013_product_prices_guardrails_after_partitioning.sql
│   ├── init.sql
│   ├── migrate.ps1
│   └── migrate.sh
├── docs
│   ├── dev
│   │   ├── PR_DESCRIPTION.md
│   │   ├── PR_body_ru_extended_wineries_sku_20251130dd30112025.md
│   │   ├── README-before06112025.md
│   │   ├── README-before07112025-01.md
│   │   ├── README-before07112025.md
│   │   ├── README-before15112025.md
│   │   ├── README-before17112025-01.md
│   │   ├── README-before17112025.md
│   │   ├── README-before18112025-01.md
│   │   ├── README-before18112025.md
│   │   ├── README-before19112025-01.md
│   │   ├── README-before19112025.md
│   │   ├── README-before21112025.md
│   │   ├── README-before22112025.md
│   │   ├── README-before22122025.md
│   │   ├── README-before24112025.md
│   │   ├── README-before28112025.md
│   │   ├── README-before30112025.md
│   │   ├── README.auto_images.ru-28112025.md
│   │   ├── README.auto_images.ru.extended-28112025.md
│   │   ├── README.extradd04122025.md
│   │   ├── README.ru-additiondd28112025.md
│   │   ├── README.wineriesdd30112025.md
│   │   ├── READMEdd04122025.md
│   │   ├── backup-dr-runbook.md
│   │   ├── cheatsheet-from-clean-clone-to-green-tests.md
│   │   ├── cleanup-test-data.md
│   │   ├── dev-setup-windows.md
│   │   ├── export-web-ui.md
│   │   ├── gitignore.md
│   │   ├── how-to-create-analysis-bundle.md
│   │   ├── issue-83-84-notes.md
│   │   ├── issue-85-partitioning-notes.md
│   │   ├── issue-91-summary.md
│   │   ├── logging-eventsdd05122025.md
│   │   ├── manual-smoke-checkdd03122025.md
│   │   ├── pricing-rules.md
│   │   ├── producer_site_image_url_readme_ru.md
│   │   ├── readme-inventory-and-chartsdd03122025.md
│   │   ├── readme_block_new_products_fields_ru.md
│   │   ├── readme_wine_fields_export.md
│   │   ├── release-notes-2025-12-16.md
│   │   ├── release-notes-2025-12-21.md
│   │   ├── web-ui.md
│   │   └── windows-powershell-http.md
│   ├── BEFORE_AFTER_COMPARISON.md
│   ├── README_UPDATE_SUMMARY.md
│   ├── ROADMAP_v3_RU.md
│   ├── dev-checklist.ps1
│   ├── manual-smoke-check.md
│   ├── pr-93-summary.md
│   ├── requirements.md
│   ├── roadmap_sprint7+.md
│   └── roadmap_sprint7+_v2.md
├── etl
│   ├── image_extractor.py
│   ├── mapping_template.json
│   ├── run_daily.py
│   └── utils.py
├── jobs
│   ├── cleanup_old_partitions.py
│   └── ingest_dw_price.py
├── observability
│   ├── grafana
│   │   ├── dashboards
│   │   │   ├── wine-assistant-api.json
│   │   │   └── wine-assistant-backup-dr.json
│   │   └── provisioning
│   │       ├── dashboards
│   │       │   └── dashboards.yml
│   │       └── datasources
│   │           └── datasources.yml
│   ├── README.md
│   ├── loki-config.yml
│   └── promtail-config.yml
├── ops
│   └── backup
│       ├── Dockerfile
│       └── backup.sh
├── scripts
│   ├── __init__.py
│   ├── backfill_current_prices.py
│   ├── bundle.ps1
│   ├── check_migrations.py
│   ├── check_wineries_vs_products.py
│   ├── cleanup_test_data.py
│   ├── data_quality.py
│   ├── date_extraction.py
│   ├── dr_smoke.ps1
│   ├── emit_event.py
│   ├── enrich_producers.py
│   ├── extract_wineries_from_pdf.py
│   ├── idempotency.py
│   ├── load_csv.py
│   ├── load_utils.py
│   ├── load_wineries.py
│   ├── load_wineries_enrichment.py
│   ├── make_analysis_bundle.ps1
│   ├── manual_smoke_check.ps1
│   ├── migrate.ps1
│   ├── minio_backups.py
│   ├── normalize_wineries_suppliers.py
│   ├── prune_local_backups.py
│   ├── quick_smoke_check.ps1
│   ├── run_integration_tests.ps1
│   ├── setup_scheduler.ps1
│   ├── smoke_backup_restore.ps1
│   └── sync_inventory_history.py
├── tests
│   ├── e2e
│   │   └── __init__.py
│   ├── fixtures
│   │   ├── schema.sql
│   │   └── schema_prices.sql
│   ├── integration
│   │   ├── __init__.py
│   │   ├── api_test_utils.py
│   │   ├── conftest.py
│   │   ├── test_api_export_search.py
│   │   ├── test_api_export_sku_and_price_history.py
│   │   ├── test_api_products_search_happy.py
│   │   └── test_price_import_etl.py
│   ├── unit
│   │   ├── __init__.py
│   │   ├── test_data_quality.py
│   │   ├── test_date_extraction.py
│   │   ├── test_export_service.py
│   │   ├── test_health.py
│   │   ├── test_idempotency.py
│   │   ├── test_load_csv.py
│   │   ├── test_load_utils.py
│   │   ├── test_schemas.py
│   │   └── test_validation.py
│   ├── README.md
│   ├── __init__.py
│   ├── conftest.py
│   ├── cors-test.html
│   ├── test_api_health.py
│   ├── test_api_limits_and_security.py
│   ├── test_api_products_happy.py
│   ├── test_api_products_validation.py
│   └── test_api_search_validation.py
├── .coveragerc
├── .dockerignore
├── .env.example
├── .gitattributes
├── .gitignore
├── .gitleaks.toml
├── .pre-commit-config.yaml
├── CHANGELOG.md
├── Dockerfile
├── INDEX.md
├── Makefile
├── PROTECTION_CHECK.txt
├── QUICK_REFERENCE.md
├── README.md
├── docker-compose.observability.yml
├── docker-compose.storage.yml
├── docker-compose.yml
├── project-structure.txt
├── pyproject.toml
├── pytest.ini
└── requirements.txt
```

## Working directory snapshot (from `tree /F /A` + `Dump-Dir`)

### Untracked items at repository root

Untracked directories at root (subdirs/files counts derived from `tree /F /A`):

| Dir | Subdirs | Files |
| --- | ------- | ----- |
| .idea | 1 | 8 |
| .pytest_cache | 2 | 5 |
| .ruff_cache | 2 | 14 |
| .venv | 1958 | 16094 |
| _bundles | 0 | 2 |
| backups | 0 | 6 |
| htmlcov | 0 | 33 |
| logs | 1 | 18 |
| restore_tmp | 0 | 1 |
| smoke_artifacts | 0 | 3 |
| static | 1 | 296 |

Untracked files at root:

- `.coverage`
- `.env`
- `.env.backup`
- `Makefile-backup`
- `docker-compose.observability.yml.backup`
- `ls_api.txt`
- `ls_api_templates.txt`
- `ls_db.txt`
- `ls_db_migrations.txt`
- `ls_docs.txt`
- `ls_docs_dev.txt`
- `ls_etl.txt`
- `ls_github.txt`
- `ls_hooks.txt`
- `ls_observability.txt`
- `ls_root.txt`
- `ls_scripts.txt`
- `ls_static.txt`
- `ls_tests.txt`
- `must-have-check.txt`
- `project-files.tracked.txt`
- `project-structure-auto.txt`
- `structure_dump.zip`
- `wine-assistant_analysis_bundle_20251221_224949.zip`

### Untracked items inside tracked directories (observed)

- `api/`
  - Backups: `api/templates/ui.html.backup`, `api/templates/ui.html.backup1`
  - Python bytecode cache: `api/__pycache__/*.pyc` (7 files)
- `etl/`
  - Backups: `etl/image_extractor.py.backup`, `etl/image_extractor.py.backup1`
  - Python bytecode cache: `etl/__pycache__/*.pyc` (1 file)
- `scripts/`
  - Backups: `scripts/dr_smoke.ps1.backup`, `scripts/load_utils.py.backup`, `scripts/load_utils.py.backup1`, `scripts/minio_backups.py.backup`
  - Local variants: `scripts/manual_smoke_check.fixed.v4.ps1`, `scripts/quick_smoke_check.fixed.v4.ps1`
  - Python bytecode cache: `scripts/__pycache__/*.pyc` (15 files)
- `tests/`
  - Python bytecode cache: `tests/**/__pycache__/*.pyc` (26 files)
- `docs/`
  - `docs/dev/README.snippetdd17122025.md`
- `data/`
  - `data/catalog/*` (5 files; includes multiple `wineries_enrichment*.xlsx` and one PDF)
  - `data/inbox/*` (18 files; `.xlsx` price lists; filenames include Cyrillic characters)
- `observability/`
  - `observability/promtail-config.yml.backup`

### Selected contents of notable untracked root directories (examples)

- `backups/` (6 files)
  - backups/db_20251213_215134.sql
  - backups/pgdata_20251213_215415.tgz
  - backups/static_images_20251213_215631.zip
  - backups/wine_db_20251222_140049_172449_16544.dump
  - backups/wine_db_20251222_142605_333267_15472.dump
  - backups/wine_db_20251222_225916_208294_12384.dump
- `restore_tmp/` (1 file)
  - restore_tmp/remote_latest.dump
- `smoke_artifacts/` (3 files)
  - smoke_artifacts/inventory_history_D010210.xlsx
  - smoke_artifacts/price_history_D010210.xlsx
  - smoke_artifacts/sku_D010210.pdf
- `_bundles/` (2 files)
  - _bundles/wine-assistant_analysis_bundle_20251221_030310.zip
  - _bundles/wine-assistant_analysis_bundle_20251221_225622.zip
- `static/` (296 files; primarily images under `static/images/`)
  - Examples:
  - static/images/Alsace___������.png
  - static/images/D000081.jpeg
  - static/images/Red_wine___�������_����.png
  - static/images/Rose_wine___�������_����.png

## Must-have check (from `must-have-check.txt`)

| Path | Exists |
| ---- | ------ |
| README.md | True |
| CHANGELOG.md | True |
| Dockerfile | True |
| docker-compose.yml | True |
| docker-compose.observability.yml | True |
| requirements.txt | True |
| Makefile | True |
| project-structure.txt | True |
| db/migrate.sh | True |
| db/init.sql | True |
| api/app.py | True |
| api/export.py | True |
| api/wsgi.py | True |
| api/templates/ui.html | True |

# Wine Assistant üç∑

[![CI](https://github.com/glinozem/wine-assistant/actions/workflows/ci.yml/badge.svg)](../../actions/workflows/ci.yml)
[![Semgrep](https://github.com/glinozem/wine-assistant/actions/workflows/semgrep.yml/badge.svg)](../../actions/workflows/semgrep.yml)
[![Secrets](https://github.com/glinozem/wine-assistant/actions/workflows/secrets.yml/badge.svg)](../../actions/workflows/secrets.yml)

**Production-ready —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–Ω–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º** —Å REST API, ETL-–ø–∞–π–ø–ª–∞–π–Ω–æ–º, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –≤–∏–Ω–æ–¥–µ–ª–µ–Ω, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–ø–æ—Ä—Ç–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏—Å—Ç–æ—Ä–∏–µ–π –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö.

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, Wine Assistant –≤—ã—Ä–æ—Å –≤ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–µ–µ best practices —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π backend-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Python.

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** Production-ready ‚Ä¢ 164+ —Ç–µ—Å—Ç–æ–≤ ‚Ä¢ Sprint 7 –∑–∞–≤–µ—Ä—à—ë–Ω ‚úÖ ‚Ä¢ AI Integration –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è (Sprint 8) üîú

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∏ ETL

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–≤** (Excel/CSV) —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ Excel** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `image_url`
- **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω** (`wineries`) –∏–∑ PDF-–∫–∞—Ç–∞–ª–æ–≥–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
- **Enrichment –∫–∞—Ç–∞–ª–æ–≥–∞** –¥–∞–Ω–Ω—ã–º–∏ –æ —Ä–µ–≥–∏–æ–Ω–µ, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ, —Å–∞–π—Ç–∞—Ö –≤–∏–Ω–æ–¥–µ–ª–µ–Ω
- **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤** –≤ `inventory_history` –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **–ö–∞—Ä–∞–Ω—Ç–∏–Ω –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (Data Quality Gates)
- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –∑–∞–≥—Ä—É–∑–æ–∫ —á–µ—Ä–µ–∑ SHA-256 —Ö–µ—à–∏
- **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ç–∞–±–ª–∏—Ü –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### üîå REST API & –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **–ü—É–±–ª–∏—á–Ω—ã–π –ø–æ–∏—Å–∫** –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- **SKU –∫–∞—Ä—Ç–æ—á–∫–∞** —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ –≤–∏–Ω–æ–¥–µ–ª—å–Ω–µ
- **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω** –∏ **–∏—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤** –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º
- **Swagger/OpenAPI** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- **API-key –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö endpoints
- **Structured JSON logging** —Å request tracking
- **Health checks** (liveness/readiness) –¥–ª—è Kubernetes
- **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

### üì§ –≠–∫—Å–ø–æ—Ä—Ç –∏ –æ—Ç—á—ë—Ç—ã

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:** JSON, Excel (.xlsx), PDF
- **–≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞** —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- **PDF-–∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤** —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –≤ Excel** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- **–ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ Excel/JSON** —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–æ–π
- **Unicode –ø–æ–¥–¥–µ—Ä–∂–∫–∞** –≤ PDF (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞, —Å–∏–º–≤–æ–ª ‚ÇΩ)
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞

### üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

- **–ì—Ä–∞—Ñ–∏–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω** (Chart.js) –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- **–ì—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤** –ø–æ SKU
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–∑—ã** —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ (`from`/`to`)
- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è BI** (Excel/JSON)

### üñºÔ∏è –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ Excel-–ø—Ä–∞–π—Å–æ–≤
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–¥–∞—á–∞** —á–µ—Ä–µ–∑ `/static/images/<SKU>.<ext>`
- **–ü—É–±–ª–∏—á–Ω—ã–µ URL** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —ç–∫—Å–ø–æ—Ä—Ç—ã** (XLSX —Å –∫–æ–ª–æ–Ω–∫–æ–π "–§–æ—Ç–æ (URL)", PDF —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º)

### üèõÔ∏è –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω

- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è—Ö
- **–ò–º–ø–æ—Ä—Ç –∏–∑ PDF-–∫–∞—Ç–∞–ª–æ–≥–∞** —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞–∑–≤–∞–Ω–∏–π
- **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** —Ä–µ–≥–∏–æ–Ω–æ–º –∏ —Å–∞–π—Ç–æ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è
- **–†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è** –∏ **–æ–ø–∏—Å–∞–Ω–∏—è** –≤–∏–Ω–æ–¥–µ–ª–µ–Ω –¥–ª—è –≤–∏—Ç—Ä–∏–Ω—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** `products` ‚Üî `wineries`

### ü§ñ AI Capabilities (–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - Sprint 8)

> ‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** AI-—Å–ª–æ–π –µ—â—ë –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –¥–∏–∑–∞–π–Ω –∏ –ø–ª–∞–Ω —Ä–∞–±–æ—Ç Sprint 8.
>
> –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: Issues #128-134 –æ—Ç–∫—Ä—ã—Ç—ã, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

**–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- **OpenAI/VseLLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è LLM-—Ñ—É–Ω–∫—Ü–∏–π (Issue #128)
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–µ embeddings** –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ (Issue #129)
- **Semantic Search** –ø–æ –æ–ø–∏—Å–∞–Ω–∏—è–º –≤–∏–Ω (Issue #130)
- **AI Wine Description Generator** - –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π (Issue #131)
- **AI Testing Infrastructure** (Issue #132)
- **AI Wine Sommelier** —Å –ø–∞–º—è—Ç—å—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (LangGraph) (Issue #134)
- **AI Monitoring Dashboard** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ (Issue #133)
- **Cascade Model Architecture** (nano ‚Üí mini ‚Üí sonnet-4) –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞—Ç

### üõ†Ô∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- **Docker Compose** –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å PostgreSQL 16 + pgvector
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏** –ë–î —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **CI/CD Pipeline** —Å GitHub Actions
- **Pre-commit hooks** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞
- **Adminer** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
- **Smoke-check —Å–∫—Ä–∏–ø—Ç—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/glinozem/wine-assistant.git
cd wine-assistant

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

# –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
docker compose up -d --build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
curl http://localhost:18000/ready
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- API: http://localhost:18000
- Swagger UI: http://localhost:18000/docs
- Adminer (–ë–î): http://localhost:18080
- Static Images: http://localhost:18000/static/images/

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
# Linux/macOS:
source .venv/bin/activate
# Windows (PowerShell):
.venv\Scripts\Activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î (—Ç—Ä–µ–±—É–µ—Ç—Å—è PostgreSQL 16+)
cp .env.example .env
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DB_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
FLASK_ENV=development FLASK_APP=api.wsgi:app flask run
```

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (Smoke Check)

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å—Ç–µ–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –±—ã—Å—Ç—Ä—ã–π smoke-check:

```powershell
# Windows PowerShell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API –∫–ª—é—á
$env:API_KEY = "–í–ê–®_API_–ö–õ–Æ–ß"

# –ë—ã—Å—Ç—Ä—ã–π smoke-check
.\scripts\quick_smoke_check.ps1

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π smoke-check —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
.\scripts\manual_smoke_check.ps1
```

–°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—Ç:
- Health endpoints (`/live`, `/ready`, `/health`)
- –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É
- –ö–∞—Ä—Ç–æ—á–∫–∏ SKU
- –ò—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Presentation Layer                   ‚îÇ
‚îÇ  ‚Ä¢ REST API (Flask)                          ‚îÇ
‚îÇ  ‚Ä¢ Swagger Documentation                     ‚îÇ
‚îÇ  ‚Ä¢ Request Middleware & Logging              ‚îÇ
‚îÇ  ‚Ä¢ Static Files Server (/static/images)      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   üîú AI/ML Layer (PLANNED - Sprint 8)        ‚îÇ
‚îÇ  ‚Ä¢ OpenAI/VseLLM Integration                 ‚îÇ
‚îÇ  ‚Ä¢ Embeddings Generator (text-embed-3-small) ‚îÇ
‚îÇ  ‚Ä¢ Semantic Search Engine                    ‚îÇ
‚îÇ  ‚Ä¢ AI Sommelier (LangGraph)                  ‚îÇ
‚îÇ  ‚Ä¢ Token Optimizer & Cost Tracking           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         Business Logic                       ‚îÇ
‚îÇ  ‚Ä¢ Product Service                           ‚îÇ
‚îÇ  ‚Ä¢ Price Management                          ‚îÇ
‚îÇ  ‚Ä¢ Inventory History Sync                    ‚îÇ
‚îÇ  ‚Ä¢ Wineries Enrichment                       ‚îÇ
‚îÇ  ‚Ä¢ Export Service (XLSX/PDF/JSON)            ‚îÇ
‚îÇ  ‚Ä¢ Data Validation (Pydantic)                ‚îÇ
‚îÇ  ‚Ä¢ Image Extraction & Storage                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         Data Access Layer                    ‚îÇ
‚îÇ  ‚Ä¢ PostgreSQL 16 + pgvector                  ‚îÇ
‚îÇ  ‚Ä¢ Migrations (Alembic-style)                ‚îÇ
‚îÇ  ‚Ä¢ Connection Pooling                        ‚îÇ
‚îÇ  ‚Ä¢ Partitioned Tables (quarterly)            ‚îÇ
‚îÇ  ‚Ä¢ Vector Similarity Search (HNSW) - ready   ‚îÇ
‚îÇ  ‚Ä¢ Wineries Reference Table                  ‚îÇ
‚îÇ  ‚Ä¢ Inventory History Table                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. API Layer (`/api`)
- `app.py` - Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ä–æ—É—Ç–∏–Ω–≥–æ–º
- `schemas.py` - Pydantic –º–æ–¥–µ–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `export.py` - –°–µ—Ä–≤–∏—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- `request_middleware.py` - Request tracking –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `logging_config.py` - Structured JSON logging
- `validation.py` - –£—Ç–∏–ª–∏—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

#### 2. ETL Layer (`/scripts`, `/etl`)
- `load_csv.py` - –û—Å–Ω–æ–≤–Ω–æ–π ETL pipeline
- `extract_wineries_from_pdf.py` - –ü–∞—Ä—Å–∏–Ω–≥ PDF-–∫–∞—Ç–∞–ª–æ–≥–∞ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω
- `normalize_wineries_suppliers.py` - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
- `load_wineries.py` - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω –≤ –ë–î
- `enrich_producers.py` - –û–±–æ–≥–∞—â–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- `check_wineries_vs_products.py` - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `sync_inventory_history.py` - –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤
- `image_extractor.py` - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ Excel
- `date_extraction.py` - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç
- `idempotency.py` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ —Ö–µ—à–∏
- `data_quality.py` - Data Quality Gates

#### 3. Database Layer (`/db`)
- –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
- –•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è upsert
- –ö–∞—Ä–∞–Ω—Ç–∏–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è DQ
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω (`wineries`)
- –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ (`inventory_history`)
- –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (HNSW) –¥–ª—è pgvector (–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ AI)

#### 4. AI Layer (`/api/ai`) - –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Sprint 8) üîú

> **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–∏ –º–æ–¥—É–ª–∏ –µ—â—ë –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ù–∏–∂–µ - –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.

- `config.py` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (OpenAI/VseLLM)
- `llm_service.py` - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è LLM
- `embeddings.py` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ embeddings
- `semantic_search.py` - –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—è–º
- `sommelier.py` - AI-—Å–æ–º–µ–ª—å–µ —Å –ø–∞–º—è—Ç—å—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- `token_optimizer.py` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤
- `model_selector.py` - –ö–∞—Å–∫–∞–¥–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### `products`
–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É SKU:
- –ë–∞–∑–æ–≤—ã–µ: `code`, `name`, `title_ru`, `country`, `region`, `color`, `style`
- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: `grapes`, `vintage`, `alcohol`
- –¶–µ–Ω—ã: `price_list_rub`, `price_final_rub`, `discount_pct`
- –û—Å—Ç–∞—Ç–∫–∏: `stock_total`, `stock_free`
- –ü–æ—Å—Ç–∞–≤—â–∏–∫: `supplier`, `producer_site`
- –†–µ–π—Ç–∏–Ω–≥–∏: `vivino_rating`, `vivino_url`
- –ú–µ–¥–∏–∞: `image_url`
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫: —Å–≤—è–∑—å —Å `wineries` –ø–æ `supplier`

#### `product_prices`
–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω —Å –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
- `code`, `effective_from`, `effective_to`
- `price_rub`, `discount_pct`
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º (Issue #85)

#### `inventory`
–¢–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:
- `code`, `stock_total`, `stock_free`, `reserved`
- `last_updated`

#### `inventory_history`
–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:
- `code`, `stock_total`, `stock_free`, `reserved`
- `as_of` - timestamp —Å–Ω–∏–º–∫–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
- –ù–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ —á–µ—Ä–µ–∑ `sync_inventory_history.py`

#### `wineries`
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π (Issue #127):
- `supplier` - –∫–ª—é—á —Å–≤—è–∑–∏ —Å `products.supplier`
- `supplier_ru` - —Ä—É—Å—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–Ω–æ–¥–µ–ª—å–Ω–∏
- `region` - –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω
- `producer_site` - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç
- `description_ru` - –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞

#### `price_list_quarantine`
–ö–∞—Ä–∞–Ω—Ç–∏–Ω –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø—Ä–∞–π—Å–∞:
- –°—Ç—Ä–æ–∫–∏, –Ω–µ –ø—Ä–æ—à–µ–¥—à–∏–µ Data Quality Gates
- `code`, `raw_row`, `error_reason`
- –î–ª—è —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### `file_imports`
–ñ—É—Ä–Ω–∞–ª –∏–º–ø–æ—Ä—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤:
- `file_sha256` - —Ö–µ—à –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- `filename`, `import_date`, `status`

### –°—Ö–µ–º–∞ —Å–≤—è–∑–µ–π

```
products
  ‚îî‚îÄ‚îÄ> supplier (FK) ‚îÄ‚îÄ> wineries.supplier
  ‚îî‚îÄ‚îÄ> code ‚îÄ‚îÄ> product_prices.code (1:many)
  ‚îî‚îÄ‚îÄ> code ‚îÄ‚îÄ> inventory.code (1:1)
  ‚îî‚îÄ‚îÄ> code ‚îÄ‚îÄ> inventory_history.code (1:many)
```

---

## üîå API Endpoints

### Health & Status
- `GET /live` - Liveness probe
- `GET /ready` - Readiness probe (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ë–î)
- `GET /health` - –ü—Ä–æ—Å—Ç–æ–π health check

### Catalog & Search
- `GET /api/v1/products/search` - –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É
  - Query params: `query`, `color`, `country`, `in_stock`, `limit`, `offset`
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, pagination
- `GET /catalog/search` - –ê–ª–∏–∞—Å `/api/v1/products/search`

### SKU Details
- `GET /api/v1/sku/<code>` - –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞
  - –í–∫–ª—é—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `products` –∏ `wineries`
  - –ê–∫—Ç—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∏ –æ—Å—Ç–∞—Ç–∫–∏
  - –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Å–∞–π—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è

### Price History
- `GET /api/v1/sku/<code>/price-history` - –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –ø–æ SKU
  - Query params: `from`, `to`, `limit`, `offset`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω

### Inventory History
- `GET /api/v1/sku/<code>/inventory-history` - –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ SKU
  - Query params: `from`, `to`, `limit`, `offset`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–Ω–∏–º–∫–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –¥–Ω—è–º
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

### Export
- `GET /export/search` - –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
  - Query params: `format` (json/xlsx/pdf), —Ñ–∏–ª—å—Ç—Ä—ã –∫–∞–∫ –≤ search
- `GET /export/sku/<code>` - –≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞
  - Query params: `format` (json/pdf)
- `GET /export/price-history/<code>` - –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω
  - Query params: `format` (json/xlsx), `from`, `to`, `limit`
- `GET /export/inventory-history/<code>` - –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
  - Query params: `format` (json/xlsx), `from`, `to`, `limit`

### Static Files
- `GET /static/images/<filename>` - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
  - –§–æ—Ä–º–∞—Ç: `<SKU>.<ext>` (jpg, jpeg, png)
  - –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### AI Endpoints (–ü–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è - Sprint 8) üîú

- `POST /api/v1/ai/search/semantic` - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—è–º
- `POST /api/v1/ai/sommelier/chat` - –î–∏–∞–ª–æ–≥ —Å AI-—Å–æ–º–µ–ª—å–µ
- `POST /api/v1/ai/descriptions/generate` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤
- `GET /api/v1/ai/embeddings/status` - –°—Ç–∞—Ç—É—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ embeddings

–í—Å–µ AI endpoints –∑–∞—â–∏—â–µ–Ω—ã API-key –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π.

---

## üì§ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### PowerShell

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ API –∫–ª—é—á–∞
$env:API_KEY = "–í–ê–®_API_–ö–õ–Æ–ß"
$baseUrl = "http://localhost:18000"
$headers = @{ "X-API-Key" = $env:API_KEY }

# –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
Invoke-RestMethod "$baseUrl/api/v1/products/search?limit=5&in_stock=true" -Headers $headers

# –ö–∞—Ä—Ç–æ—á–∫–∞ SKU
$code = "D010210"
Invoke-RestMethod "$baseUrl/api/v1/sku/$code" -Headers $headers

# –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
Invoke-RestMethod "$baseUrl/api/v1/sku/$code/price-history?from=2025-01-01&to=2025-12-31" -Headers $headers

# –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤
Invoke-RestMethod "$baseUrl/api/v1/sku/$code/inventory-history?from=2025-01-01&to=2025-12-31" -Headers $headers

# –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
$url = "$baseUrl/export/inventory-history/${code}?format=xlsx&limit=100"
Invoke-WebRequest $url -Headers $headers -OutFile "inventory_$code.xlsx"
```

#### curl + jq (Windows/Linux)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
export API_KEY="–í–ê–®_API_–ö–õ–Æ–ß"
export BASE_URL="http://localhost:18000"

# –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
curl -H "X-API-Key: $API_KEY" \
  "$BASE_URL/api/v1/products/search?color=red&country=–§—Ä–∞–Ω—Ü–∏—è&limit=10" | jq

# –ö–∞—Ä—Ç–æ—á–∫–∞ SKU —Å –≤—ã–±–æ—Ä–æ–º –ø–æ–ª–µ–π
curl -H "X-API-Key: $API_KEY" \
  "$BASE_URL/api/v1/sku/D010210" | \
  jq '{code, name, price_final_rub, stock_free, vivino_rating}'

# –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
curl -H "X-API-Key: $API_KEY" \
  "$BASE_URL/api/v1/sku/D010210/inventory-history?from=2025-01-01&to=2025-12-31&limit=50" | \
  jq '.items[] | {as_of, stock_total, stock_free}'
```

---

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `inventory_history` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º:

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
python scripts/sync_inventory_history.py

# –ß–µ—Ä–µ–∑ Docker
docker compose exec api python scripts/sync_inventory_history.py

# Dry-run —Ä–µ–∂–∏–º (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î)
python scripts/sync_inventory_history.py --dry-run

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –¥–∞—Ç—É
python scripts/sync_inventory_history.py --as-of 2025-12-05T00:00:00
```

–ß–µ—Ä–µ–∑ Makefile:

```bash
# Dry-run
make sync-inventory-history-dry-run

# –†–µ–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
make sync-inventory-history
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

#### Windows Task Scheduler

–î–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞–¥–∞—á—É –≤ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ –∑–∞–¥–∞–Ω–∏–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Task Scheduler** (–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π)
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É (Create Task...)
3. **Triggers**: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 03:00
4. **Actions**:
   - Program: `powershell.exe`
   - Arguments:
     ```
     -NoProfile -ExecutionPolicy Bypass -Command "cd 'D:\path\to\wine-assistant'; make sync-inventory-history"
     ```

#### Linux/WSL Cron

```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ:

```cron
0 3 * * * cd /opt/wine-assistant && make sync-inventory-history >> /var/log/wine-sync.log 2>&1
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ inventory_history

#### –ß–µ—Ä–µ–∑ SQL

```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–Ω–∏–º–∫–∏
SELECT code, stock_total, stock_free, reserved, as_of
FROM inventory_history
ORDER BY as_of DESC
LIMIT 50;

-- –ò—Å—Ç–æ—Ä–∏—è –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É SKU
SELECT code, stock_total, stock_free, as_of
FROM inventory_history
WHERE code = 'D010210'
ORDER BY as_of DESC;
```

#### –ß–µ—Ä–µ–∑ API

```powershell
$code = "D010210"
curl.exe -H "X-API-Key: $env:API_KEY" `
  "$baseUrl/api/v1/sku/$code/inventory-history?from=2020-01-01&to=2030-12-31" | jq
```

---

## üìà –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (Chart.js)

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ui.html` —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ Chart.js.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏

#### –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω

```javascript
async function loadPriceHistory(code) {
  const response = await apiGet(`/sku/${code}/price-history`, {
    from: '2020-01-01',
    to: '2030-12-31',
    limit: 100
  });

  const ctx = document.getElementById('priceChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: response.items.map(p => p.effective_from),
      datasets: [{
        label: '–¶–µ–Ω–∞, ‚ÇΩ',
        data: response.items.map(p => p.price_rub),
        borderColor: 'rgba(75, 192, 192, 1)',
        backgroundColor: 'rgba(75, 192, 192, 0.15)',
        tension: 0.2
      }]
    },
    options: {
      responsive: true,
      plugins: {
        tooltip: {
          callbacks: {
            label: (context) => {
              const value = context.parsed.y;
              return `–¶–µ–Ω–∞: ${value.toLocaleString('ru-RU')} ‚ÇΩ`;
            }
          }
        }
      }
    }
  });
}
```

#### –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤

```javascript
async function loadInventoryHistory(code) {
  const response = await apiGet(`/sku/${code}/inventory-history`, {
    from: '2020-01-01',
    to: '2030-12-31',
    limit: 100
  });

  const ctx = document.getElementById('inventoryChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: response.items.map(p => p.as_of),
      datasets: [
        {
          label: '–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫',
          data: response.items.map(p => p.stock_total),
          borderColor: 'rgba(54, 162, 235, 1)',
          backgroundColor: 'rgba(54, 162, 235, 0.15)'
        },
        {
          label: '–°–≤–æ–±–æ–¥–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫',
          data: response.items.map(p => p.stock_free),
          borderColor: 'rgba(75, 192, 192, 1)',
          backgroundColor: 'rgba(75, 192, 192, 0.15)',
          borderDash: [4, 4]
        }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
}
```

### HTML —Ä–∞–∑–º–µ—Ç–∫–∞

```html
<div class="mb-3">
  <h6>–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω</h6>
  <canvas id="priceChart" height="120"></canvas>
</div>

<div class="mb-3">
  <h6>–ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤</h6>
  <canvas id="inventoryChart" height="120"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:

```javascript
// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç –Ω–∞ –æ—Å–∏ X
scales: {
  x: {
    ticks: {
      callback: (value) => {
        const label = this.getLabelForValue(value);
        return label ? label.slice(0, 10) : ''; // YYYY-MM-DD
      }
    }
  }
}

// –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
scales: {
  y: {
    type: 'logarithmic',
    ticks: {
      callback: (value) => Number(value).toLocaleString('ru-RU')
    }
  }
}

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫
const recentData = allData.slice(-50); // –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Ç–æ—á–µ–∫
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=. --cov-report=html

# –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ
pytest tests/integration/

# –¢–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã
pytest tests/unit/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/integration/test_api_export_sku_and_price_history.py -v
```

### Smoke-check —Å–∫—Ä–∏–ø—Ç—ã

–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ —Å—Ç–µ–Ω–¥–∞:

```powershell
# –ë—ã—Å—Ç—Ä—ã–π smoke-check (–æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
.\scripts\quick_smoke_check.ps1

# –ü–æ–ª–Ω—ã–π smoke-check (–≤—Å–µ API endpoints)
.\scripts\manual_smoke_check.ps1
```

–°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- ‚úÖ Health endpoints (`/live`, `/ready`, `/health`)
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É (`/api/v1/products/search`)
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫—É SKU (`/api/v1/sku/<code>`)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω (`/api/v1/sku/<code>/price-history`)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—é –æ—Å—Ç–∞—Ç–∫–æ–≤ (`/api/v1/sku/<code>/inventory-history`)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (JSON/XLSX/PDF)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (number vs string)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ unit/                    # Unit-—Ç–µ—Å—Ç—ã –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_data_quality.py
‚îÇ   ‚îú‚îÄ‚îÄ test_date_extraction.py
‚îÇ   ‚îú‚îÄ‚îÄ test_idempotency.py
‚îÇ   ‚îú‚îÄ‚îÄ test_load_csv.py
‚îÇ   ‚îú‚îÄ‚îÄ test_schemas.py
‚îÇ   ‚îî‚îÄ‚îÄ test_validation.py
‚îú‚îÄ‚îÄ integration/             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API + –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ test_api_products_search_happy.py
‚îÇ   ‚îú‚îÄ‚îÄ test_api_export_sku_and_price_history.py
‚îÇ   ‚îú‚îÄ‚îÄ test_price_import_etl.py
‚îÇ   ‚îî‚îÄ‚îÄ conftest.py
‚îú‚îÄ‚îÄ e2e/                     # End-to-end —Ç–µ—Å—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
‚îú‚îÄ‚îÄ conftest.py              # –û–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îî‚îÄ‚îÄ README.md                # –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```

### Coverage

–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: **>80%**

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞
pytest --cov=. --cov-report=html
# –û—Ç—á—ë—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ htmlcov/index.html
```

---

## üèóÔ∏è –†–∞–±–æ—Ç–∞ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –≤–∏–Ω–æ–¥–µ–ª–µ–Ω

### –ò–º–ø–æ—Ä—Ç –≤–∏–Ω–æ–¥–µ–ª–µ–Ω –∏–∑ PDF-–∫–∞—Ç–∞–ª–æ–≥–∞

–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å PDF-–∫–∞—Ç–∞–ª–æ–≥–æ–º –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞:

```bash
# 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ PDF
python scripts/extract_wineries_from_pdf.py
# –†–µ–∑—É–ª—å—Ç–∞—Ç: data/catalog/wineries_enrichment_from_pdf.xlsx

# 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
python scripts/normalize_wineries_suppliers.py
# –†–µ–∑—É–ª—å—Ç–∞—Ç: data/catalog/wineries_enrichment_from_pdf_norm.xlsx

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å products
python scripts/check_wineries_vs_products.py
# –í—ã–≤–æ–¥: —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –±–µ–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, fuzzy-matching –ø–æ–¥—Å–∫–∞–∑–∫–∏

# 4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î (dry-run)
python -m scripts.load_wineries \
  --excel "data/catalog/wineries_enrichment_from_pdf_norm.xlsx"

# 5. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î (—Ä–µ–∞–ª—å–Ω–∞—è)
python -m scripts.load_wineries \
  --excel "data/catalog/wineries_enrichment_from_pdf_norm.xlsx" \
  --apply
```

### –û–±–æ–≥–∞—â–µ–Ω–∏–µ products –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ wineries

```sql
-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
UPDATE products p
SET region = w.region
FROM wineries w
WHERE p.supplier = w.supplier
  AND p.region IS NULL
  AND w.region IS NOT NULL;

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è
UPDATE products p
SET producer_site = w.producer_site
FROM wineries w
WHERE p.supplier = w.supplier
  AND p.producer_site IS NULL
  AND w.producer_site IS NOT NULL;
```

–ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:

```bash
python scripts/enrich_producers.py \
  --excel "data/catalog/wineries_enrichment_from_pdf_norm.xlsx"
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ API

–î–∞–Ω–Ω—ã–µ –∏–∑ `wineries` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç—ã API:

```json
{
  "code": "D010210",
  "name": "–í–∏–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–∞",
  "supplier": "Lake Road - Origin Wine",
  "supplier_ru": "–õ–µ–π–∫ –†–æ—É–¥ - –û—Ä–∏–¥–∂–∏–Ω –í–∞–π–Ω",
  "region": "–ú–∞–ª—å–±–æ—Ä–æ",
  "producer_site": "https://www.lakeroad.co.nz",
  "winery_name_ru": "Lake Road ‚Äî Origin Wine",
  "winery_description_ru": "–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∏–Ω–æ–¥–µ–ª—å–Ω–∏..."
}
```

---

## üîê –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ Excel

–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –ø—Ä–∞–π—Å–∞ —Å–∫—Ä–∏–ø—Ç `load_csv.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Excel
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `/app/static/images/<SKU>.<ext>`
3. –ó–∞–ø–æ–ª–Ω—è–µ—Ç `products.image_url`

```bash
python scripts/load_csv.py \
  --excel "data/inbox/–ü—Ä–∞–π—Å.xlsx" \
  --date 2025-12-01 \
  --mapping etl/mapping_template.json \
  --skip-image-extraction=false
```

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–¥–∞—á–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

Flask –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–∞—ë—Ç —Ñ–∞–π–ª—ã –∏–∑ `/static/images`:

```
GET http://localhost:18000/static/images/D010210.jpg
```

URL —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫:

```python
image_url = f"{WINE_IMAGE_BASE_URL}/{code}.{ext}"
# http://localhost:18000/static/images/D010210.jpg
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —ç–∫—Å–ø–æ—Ä—Ç–∞—Ö

#### Excel —ç–∫—Å–ø–æ—Ä—Ç

–ö–æ–ª–æ–Ω–∫–∞ "–§–æ—Ç–æ (URL)" —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

```
http://localhost:18000/static/images/D010210.jpg
```

#### PDF —ç–∫—Å–ø–æ—Ä—Ç

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ PDF-–∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞:

```python
from reportlab.lib.utils import ImageReader

if image_url:
    img = ImageReader(image_path)
    pdf.drawImage(img, x, y, width, height)
```

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### Pre-commit hooks

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
pre-commit install

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
pre-commit run --all-files
```

–ü—Ä–æ–≤–µ—Ä–∫–∏:
- Ruff (–ª–∏–Ω—Ç–∏–Ω–≥)
- Black (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- Gitleaks (–ø–æ–∏—Å–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤)
- Trailing whitespace
- YAML syntax

### Makefile –∫–æ–º–∞–Ω–¥—ã

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make install

# –õ–∏–Ω—Ç–∏–Ω–≥
make lint

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make format

# –¢–µ—Å—Ç—ã
make test

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (lint + test)
make check

# Coverage
make coverage

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤
make sync-inventory-history

# –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
make docker-build

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
make clean
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ requirements.txt
pip list --outdated
pip install -U <package>
pip freeze > requirements.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
pip-audit

# –ß–µ—Ä–µ–∑ Makefile
make audit
```

---

## üéØ AI Integration (Sprint 8) - –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ üîú

> ‚ö†Ô∏è –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–ª–∞–Ω–∏—Ä—É–µ–º—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é. –ö–æ–¥ –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AI-—Å–ª–æ—è

```python
# api/ai/config.py
class AIConfig:
    VSELLM_API_KEY = os.getenv('VSELLM_API_KEY')
    OPENAI_API_KEY = os.getenv('OPENAI_API_KEY')

    EMBEDDING_MODEL = 'text-embedding-3-small'
    EMBEDDING_DIM = 1536

    LLM_MODELS = {
        'nano': 'gpt-4.1-nano',
        'mini': 'gpt-4o-mini',
        'pro': 'claude-sonnet-4'
    }
```

### Semantic Search

```python
# api/ai/semantic_search.py
from pgvector.psycopg2 import register_vector

async def search_wines_by_description(query: str, limit: int = 10):
    """–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º embeddings"""
    embedding = await generate_embedding(query)

    results = db.execute("""
        SELECT code, name, description_ru,
               1 - (embedding <=> %s::vector) as similarity
        FROM products
        WHERE embedding IS NOT NULL
        ORDER BY embedding <=> %s::vector
        LIMIT %s
    """, (embedding, embedding, limit))

    return results
```

### AI Sommelier

```python
# api/ai/sommelier.py
from langgraph import StateGraph, Node

class SommelierAgent:
    def __init__(self):
        self.graph = StateGraph()
        self.memory = ConversationBufferMemory()

    async def chat(self, user_message: str, context: dict):
        """–î–∏–∞–ª–æ–≥ —Å –ø–∞–º—è—Ç—å—é –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        # 1. Retrieve context from memory
        # 2. Search relevant wines
        # 3. Generate response with LLM
        # 4. Update memory
        pass
```

### Cost Optimization

```python
# api/ai/token_optimizer.py
class CascadeModelSelector:
    """–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏"""

    def select_model(self, task_complexity: str) -> str:
        if task_complexity == 'simple':
            return 'gpt-4.1-nano'  # ‚ÇΩ0.15/1M tokens
        elif task_complexity == 'medium':
            return 'gpt-4o-mini'    # ‚ÇΩ1.10/1M tokens
        else:
            return 'claude-sonnet-4' # ‚ÇΩ23/1M tokens
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
# Semantic search
POST /api/v1/ai/search/semantic
{
  "query": "–ª–µ–≥–∫–æ–µ –±–µ–ª–æ–µ –≤–∏–Ω–æ –∫ —Ä—ã–±–µ",
  "limit": 10
}

# AI Sommelier chat
POST /api/v1/ai/sommelier/chat
{
  "message": "–ü–æ—Å–æ–≤–µ—Ç—É–π –≤–∏–Ω–æ –∫ —Å—Ç–µ–π–∫—É",
  "session_id": "user-123",
  "context": {
    "budget": "–¥–æ 3000 —Ä—É–±",
    "preferences": ["—Å—É—Ö–æ–µ", "–∫—Ä–∞—Å–Ω–æ–µ"]
  }
}

# Generate description
POST /api/v1/ai/descriptions/generate
{
  "code": "D010210",
  "style": "professional",
  "length": "medium"
}
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–æ–≤

```python
# api/ai/monitoring.py
class CostTracker:
    def __init__(self):
        self.db = connect_to_db()

    def log_request(self, model: str, tokens_in: int, tokens_out: int):
        cost = calculate_cost(model, tokens_in, tokens_out)
        self.db.execute("""
            INSERT INTO ai_usage_logs
            (model, tokens_in, tokens_out, cost_rub, timestamp)
            VALUES (%s, %s, %s, %s, NOW())
        """, (model, tokens_in, tokens_out, cost))
```

### Roadmap Sprint 8

| Issue | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | ETA |
|-------|--------|--------|-----|
| #128 | AI Infrastructure Setup | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 1 |
| #129 | Embeddings Generation | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 1-2 |
| #130 | Semantic Search API | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 2 |
| #131 | Description Generator | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 3 |
| #132 | AI Testing Infrastructure | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 2-4 |
| #134 | AI Sommelier (LangGraph) | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 4-5 |
| #133 | Monitoring Dashboard | üîú –û—Ç–∫—Ä—ã—Ç | –ù–µ–¥–µ–ª—è 5 |

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—Ö–æ–¥–æ–≤ (1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å) - –ø—Ä–æ–µ–∫—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞

| –ó–∞–¥–∞—á–∞ | –ú–æ–¥–µ–ª—å | –¢–æ–∫–µ–Ω—ã | –°—Ç–æ–∏–º–æ—Å—Ç—å/–¥–µ–Ω—å |
|--------|--------|--------|----------------|
| Embeddings –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | text-embed-3-small | 500K | ‚ÇΩ1.50 |
| –ë–∞–∑–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ | gpt-4o-mini | 1M | ‚ÇΩ11.00 |
| –°–ª–æ–∂–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ | claude-sonnet-4 | 100K | ‚ÇΩ23.00 |
| **–ò–¢–û–ì–û** | | **1.6M** | **‚ÇΩ35.50** |

**–ë—é–¥–∂–µ—Ç:** ~‚ÇΩ1000/–º–µ—Å—è—Ü –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

---

## ü§ù Contribution

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. –°–æ–∑–¥–∞–π—Ç–µ feature branch –æ—Ç `master`
   ```bash
   git checkout -b feature/your-feature
   ```
2. –ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ —Å —Ç–µ—Å—Ç–∞–º–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫:
   ```bash
   make check  # –ª–∏–Ω—Ç–µ—Ä + —Ç–µ—Å—Ç—ã
   ```
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞
- Python 3.11+
- Type hints –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- Docstrings –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >80%
- Ruff –¥–ª—è –ª–∏–Ω—Ç–∏–Ω–≥–∞
- Black –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–æ–º–º–∏—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ conventional commits
- –ü—Ä–∏–º–µ—Ä—ã: `feat:`, `fix:`, `docs:`, `test:`, `refactor:`
- –°—Å—ã–ª–∞–π—Ç–µ—Å—å –Ω–∞ Issues: `(Refs #123)`

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](docs/architecture.md)
- [API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è](http://localhost:18000/docs)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ ETL](docs/etl-guide.md)

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π](README.auto_images.ru.md)
- [–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω](README.wineries.md)
- [–ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –≥—Ä–∞—Ñ–∏–∫–∏](docs/inventory-history-guide.md)
- [–†—É—á–Ω–æ–π smoke-check](docs/manual-smoke-check.md)
- [–≠–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](docs/export-web-ui.md)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤](docs/readme_block_new_products_fields_ru.md)
- [AI Integration Guide](docs/ai-integration.md) - –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Sprint 8

### –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- [Windows Setup](docs/dev/dev-setup-windows.md)
- [–®–ø–∞—Ä–≥–∞–ª–∫–∞: –æ—Ç —á–∏—Å—Ç–æ–π —Å—Ä–µ–¥—ã –¥–æ –∑–µ–ª—ë–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤](docs/dev/cheatsheet-from-clean-clone-to-green-tests.md)
- [Issue #83-84: Data Quality Gates](docs/dev/issue-83-84-notes.md)
- [Issue #85: –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ](docs/dev/issue-85-partitioning-notes.md)
- [Issue #127: –í–∏–Ω–æ–¥–µ–ª—å–Ω–∏ –∏ enrichment](docs/dev/issue-127-wineries-notes.md)
- [Troubleshooting](docs/troubleshooting.md)

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **API Key –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö endpoints
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** —á–µ—Ä–µ–∑ Pydantic
- **SQL injection –∑–∞—â–∏—Ç–∞** (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- **Secrets scanning** –≤ CI/CD (Gitleaks)
- **Security headers** –≤ production
- **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏
- **Dependency scanning** —á–µ—Ä–µ–∑ pip-audit
- **SAST** —á–µ—Ä–µ–∑ Semgrep
- **API Key rotation** –¥–ª—è AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Connection pooling** –¥–ª—è –ë–î
- **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ç–∞–±–ª–∏—Ü –ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º (Issue #85)
- **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –ø–æ–∏—Å–∫–∞:
  - GIN –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
  - HNSW –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ AI)
  - B-tree –¥–ª—è SKU –∏ supplier
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç** –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **Pagination** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (limit/offset)
- **Bulk operations** –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫
- **Prepared statements** –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **AI Token optimization** - –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ *(–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Sprint 8)*
- **Cascade model selection** - –¥–µ—à—ë–≤—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á *(–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Sprint 8)*
- **Redis caching** –¥–ª—è embeddings *(–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è Sprint 9)*

---

## üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|-----------|------------|
| **Backend** | Python 3.11+, Flask, Pydantic |
| **Database** | PostgreSQL 16, pgvector, pg_trgm |
| **AI/ML** üîú | OpenAI API, VseLLM, LangChain, LangGraph *(planned Sprint 8)* |
| **Embeddings** üîú | text-embedding-3-small (1536 dim) *(planned Sprint 8)* |
| **LLM Models** üîú | gpt-4o-mini, claude-sonnet-4, gpt-4.1-nano *(planned Sprint 8)* |
| **Infrastructure** | Docker, Docker Compose, Gunicorn |
| **Testing** | pytest, coverage, integration tests |
| **CI/CD** | GitHub Actions, Semgrep, pip-audit |
| **Monitoring** | Structured logging, Health checks |
| **Documentation** | Swagger/OpenAPI, Markdown |
| **Code Quality** | Ruff, Black, Pre-commit hooks |
| **Export** | openpyxl, ReportLab (PDF), JSON |
| **Image Processing** | openpyxl (extraction), Flask (serving) |
| **PDF Parsing** | PyPDF2 (catalog extraction) |
| **Visualization** | Chart.js (frontend graphs) |

---

## üéì Learning Resources

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- ‚úÖ REST API design —Å Flask
- ‚úÖ ETL pipeline –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ PostgreSQL —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ (pgvector)
- ‚úÖ Docker containerization
- ‚úÖ CI/CD —Å GitHub Actions
- ‚úÖ Testing best practices (unit/integration/e2e)
- ‚úÖ Data Quality Gates
- ‚úÖ Image extraction –∏ static file serving
- ‚úÖ **Reference data management** (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω)
- ‚úÖ **Data enrichment workflows**
- ‚úÖ **PDF parsing –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ **Time-series data** (–∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤)
- ‚úÖ **Data visualization** (Chart.js graphs)
- ‚úÖ **Automated smoke testing** (PowerShell scripts)
- üîú **AI/ML integration** (OpenAI API, LangChain) - *Sprint 8*
- üîú **Vector search** —Å pgvector + HNSW - *Sprint 8*
- üîú **LangGraph** –¥–ª—è stateful AI conversations - *Sprint 8*
- üîú **Cost optimization** –¥–ª—è LLM-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π - *Sprint 8*

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE)

–ü—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏ –æ–±—É—á–µ–Ω–∏—è.

---

## üë• –ö–æ–º–∞–Ω–¥–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

**Maintainer:** [@glinozem](https://github.com/glinozem)

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

**–¢–µ–∫—É—â–∏–π Sprint:** Sprint 8 - AI Integration (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –î–µ–∫–∞–±—Ä—å 2025

**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
- [GitHub Issues](https://github.com/glinozem/wine-assistant/issues)
- [Project Board](https://github.com/glinozem/wine-assistant/projects)
- VseLLM Telegram: [@vsellm_bot](https://t.me/vsellm_bot)

---

## üìù –†–µ–∑—é–º–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

Wine Assistant –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ **production-ready** —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Sprint 7:

### ‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –°–ï–ô–ß–ê–° (Sprint 1-7)
1. ‚úÖ **–ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤** —Å enrichment –¥–∞–Ω–Ω—ã–º–∏
2. ‚úÖ **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω** (`wineries`) –∏–∑ PDF-–∫–∞—Ç–∞–ª–æ–≥–∞
3. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –∏–∑ Excel-–ø—Ä–∞–π—Å–æ–≤
4. ‚úÖ **SKU API** —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
5. ‚úÖ **–ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤** (`inventory_history`) —Å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
6. ‚úÖ **–ì—Ä–∞—Ñ–∏–∫–∏** –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ (Chart.js)
7. ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç** –≤ XLSX/PDF/JSON —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
8. ‚úÖ **164 –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞** (–≤—Å–µ –∑–µ–ª—ë–Ω—ã–µ)
9. ‚úÖ **Data Quality Gates** —Å –∫–∞—Ä–∞–Ω—Ç–∏–Ω–æ–º
10. ‚úÖ **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ç–∞–±–ª–∏—Ü
11. ‚úÖ **Structured logging** —Å request tracking
12. ‚úÖ **Smoke-check —Å–∫—Ä–∏–ø—Ç—ã** (PowerShell)
13. ‚úÖ **Docker-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –≥–æ—Ç–æ–≤–∞ –∫ –¥–µ–ø–ª–æ—é

### üîú –ß—Ç–æ –≤ –ê–ö–¢–ò–í–ù–û–ô –†–ê–ó–†–ê–ë–û–¢–ö–ï (Sprint 8 - AI Integration)

> **–°—Ç–∞—Ç—É—Å:** Issues #128-134 –æ—Ç–∫—Ä—ã—Ç—ã, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏

1. üîú **AI Integration** —á–µ—Ä–µ–∑ VseLLM/OpenAI API (Issue #128)
2. üîú **Semantic Search** —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º–∏ embeddings (Issues #129, #130)
3. üîú **AI Description Generator** (Issue #131)
4. üîú **AI Sommelier** —Å –ø–∞–º—è—Ç—å—é –¥–∏–∞–ª–æ–≥–æ–≤ (Issue #134)
5. üîú **AI Testing Infrastructure** (Issue #132)
6. üîú **Cost Optimization** –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞—Å—Ö–æ–¥–æ–≤ (Issue #133)

### üéØ –ú–µ—Ç—Ä–∏–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- ‚úÖ API —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ ETL pipeline –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∞–π—Å—ã
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é
- ‚úÖ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ê–≤—Ç–æ–∏–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ UI

### üìã –ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°
- ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–π—Å—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Ñ–æ—Ç–æ
- ‚úÖ –ò—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
- ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ SKU —Å –¥–∞–Ω–Ω—ã–º–∏ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –≤ Excel/PDF
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ü–µ–Ω –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤
- ‚úÖ –°—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ (Chart.js)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–≤–∏—Ç—Ä–∏–Ω–æ–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –æ—Å—Ç–∞—Ç–∫–æ–≤

### üöß –ß—Ç–æ –±—É–¥–µ—Ç –ü–û–°–õ–ï Sprint 8
- üîú –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫: "–≤–∏–Ω–æ –∫ —Å—Ç–µ–π–∫—É"
- üîú AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: "–ø–æ–¥–±–µ—Ä–∏ –≤–∏–Ω–æ –∫ –±–ª—é–¥—É"
- üîú –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –Ω–∏—Ö
- üîú –£–º–Ω—ã–π —á–∞—Ç-—Å–æ–º–µ–ª—å–µ —Å –ø–∞–º—è—Ç—å—é –¥–∏–∞–ª–æ–≥–æ–≤

**–í—ã–≤–æ–¥:** –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–≤–∏—Ç—Ä–∏–Ω–æ–π **—É–∂–µ —Å–µ–π—á–∞—Å**. AI-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–±–∞–≤–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –±—É–¥—É—â–µ–º, –Ω–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –±–ª–æ–∫–µ—Ä–æ–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞.

---

<p align="center">
  <i>Wine Assistant - –æ—Ç —É—á–µ–±–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∫ production-ready AI-powered —Å–∏—Å—Ç–µ–º–µ</i>
</p>

<p align="center">
  <strong>üç∑ Made for Wine Lovers ‚Ä¢ üèõÔ∏è Powered by Reference Data ‚Ä¢ üìà Analytics Ready ‚Ä¢ ü§ñ AI-Ready ‚Ä¢ üöÄ Built with Python</strong>
</p>
